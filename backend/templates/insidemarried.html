<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RoomieHaus Budget Tracker</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            min-height: 100vh;
            overflow: hidden;
            background: radial-gradient(circle at 65% 10%, #f3ede7 0%, #a78e81 100%);
            animation: gradientMove 16s ease-in-out infinite alternate;
        }
        @keyframes gradientMove {
            0% { background-position: 0% 50%;}
            100% { background-position: 100% 50%;}
        }
        /* Sparkles! */
        .sparkle {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0.65;
            background: radial-gradient(circle, #fff 70%, #ffe4c4 100%);
            animation: sparkleMove 8s linear infinite;
        }
        @keyframes sparkleMove {
            0% {transform: scale(0.7) translateY(0);}
            80% {opacity: 0.8;}
            100% {transform: scale(1.2) translateY(-120vh); opacity: 0;}
        }
        /* Speech Bubble */
        .speech-bubble {
            position: relative;
            background: rgba(255,255,255,0.93);
            border-radius: 0.75rem;
            padding: 0.7rem 1.2rem;
            box-shadow: 0 2px 14px 0 rgba(167,142,129,0.14), 0 1.5px 12px rgba(0,0,0,0.09);
            cursor: pointer;
            transition: transform 0.17s cubic-bezier(.68,-0.55,.27,1.55), box-shadow 0.22s;
            animation: speechIn 0.7s cubic-bezier(.68,-0.55,.27,1.55);
            will-change: transform;
        }
        @keyframes speechIn {
            0% {transform: scale(0.7) translateY(40px);}
            90% {transform: scale(1.08) translateY(-6px);}
            100% {transform: scale(1) translateY(0);}
        }
        .speech-bubble:hover {
            animation: bubblePulse 0.9s infinite alternate;
            box-shadow: 0 6px 24px 0 rgba(167,142,129,0.25), 0 2px 18px rgba(0,0,0,0.13);
            background: #faf6f4;
        }
        @keyframes bubblePulse {
            0% {transform: scale(1);}
            80% {transform: scale(1.10);}
            100% {transform: scale(1.07);}
        }
        .speech-bubble:active {
            animation: bubbleBounce 0.26s 1;
        }
        @keyframes bubbleBounce {
            0% { transform: scale(1);}
            50% { transform: scale(1.15);}
            100% { transform: scale(1);}
        }
        .speech-bubble::after {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border: 12px solid transparent;
            border-top-color: #fff;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            filter: drop-shadow(0 2px 3px rgba(167,142,129,0.12));
        }
        /* 3D Model glowing border */
        .glow-border {
            box-shadow: 0 0 16px 3px #a78e81cc, 0 0 0 6px #e8d9c8aa;
            border-radius: 0.75rem;
            animation: borderGlow 2.4s ease-in-out infinite alternate;
        }
        @keyframes borderGlow {
            0% { box-shadow: 0 0 16px 3px #a78e81cc, 0 0 0 6px #e8d9c8aa;}
            100% { box-shadow: 0 0 24px 7px #a78e81ff, 0 0 0 12px #e8d9c840;}
        }
        /* Floating effect */
        .float {
            animation: floatY 3.7s ease-in-out infinite alternate;
        }
        @keyframes floatY {
            0% {transform: translateY(0);}
            100% {transform: translateY(-18px);}
        }
        /* Back arrow button pulse and glow */
        .back-button {
            background: rgba(167, 142, 129, 0.25);
            color: #fff;
            border-radius: 9999px;
            padding: 0.8rem;
            box-shadow: 0 4px 16px rgba(167, 142, 129, 0.22);
            transition: background 0.33s, box-shadow 0.18s, transform 0.15s;
            cursor: pointer;
            outline: none;
            animation: btnPulse 2.1s infinite alternate;
        }
        @keyframes btnPulse {
            0% {box-shadow: 0 0 12px 0 #a78e8150;}
            80% {box-shadow: 0 0 22px 2px #a78e8122;}
            100% {box-shadow: 0 0 26px 5px #a78e8160;}
        }
        .back-button:hover {
            background: linear-gradient(90deg, #a78e81 60%, #e3dcd3 100%);
            color: #fff;
            box-shadow: 0 0 18px 6px #a78e81cc, 0 0 0 2px #fff2;
            transform: scale(1.12);
        }
        /* Message box styling with in/out animation */
        .message-box-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            background: rgba(0,0,0,0.45);
            display: flex; justify-content: center; align-items: center;
            z-index: 1000;
            opacity: 0; visibility: hidden;
            transition: opacity 0.32s cubic-bezier(.68,-0.55,.27,1.55), visibility 0.32s;
        }
        .message-box-overlay.active {
            opacity: 1; visibility: visible;
        }
        .message-box-content {
            background: linear-gradient(130deg, #fff 80%, #e9e4e0 100%);
            padding: 2.2rem 1.6rem 1.6rem 1.6rem;
            border-radius: 1.25rem;
            box-shadow: 0 8px 24px 0 rgba(0,0,0,0.18);
            text-align: center;
            max-width: 92vw;
            color: #4a4a4a;
            transform: translateY(64px) scale(0.97);
            opacity: 0;
            animation: msgIn 0.36s cubic-bezier(.68,-0.55,.27,1.55) forwards;
            will-change: transform, opacity;
        }
        .message-box-overlay:not(.active) .message-box-content {
            animation: none;
        }
        @keyframes msgIn {
            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }
        .message-box-content button {
            background: linear-gradient(92deg,#a78e81 70%, #e3dcd3 100%);
            color: white;
            padding: 0.7rem 1.7rem;
            border-radius: 0.6rem;
            margin-top: 1.4rem;
            font-size: 1.12rem;
            font-weight: 500;
            letter-spacing: 0.03em;
            border: none;
            transition: background 0.22s, transform 0.15s, box-shadow 0.16s;
            box-shadow: 0 2px 10px rgba(167,142,129,0.14);
        }
        .message-box-content button:hover {
            background: #a78e81;
            box-shadow: 0 2px 16px #a78e81a0;
            transform: scale(1.055) translateY(-2px);
        }
        /* Glassmorphic prompt box */
        .prompt-box {
            background: rgba(255,255,255,0.38);
            color: #7d5c46;
            padding: 2.1rem 1.3rem;
            border-radius: 1.2rem;
            box-shadow: 0 2.5px 16px #a78e8144, 0 0.5px 5px #0001;
            backdrop-filter: blur(10px) saturate(150%);
            border: 1.5px solid #e3dcd3b8;
            font-size: 1.14rem;
            font-weight: 500;
        }
        /* Entrance animation */
        .main-content-entrance {
            opacity: 0;
            transform: translateY(72px) scale(0.97);
            animation: mainIn 1.05s cubic-bezier(.68,-0.55,.27,1.55) forwards;
        }
        @keyframes mainIn {
            100% { opacity: 1; transform: none;}
        }
        /* Responsive tweaks */
        @media (max-width: 768px) {
            .message-box-content {padding: 1.1rem 0.6rem 1rem 0.6rem;}
            .prompt-box {padding: 1.1rem 0.5rem;}
        }
    </style>
</head>
<body class="relative">

    <!-- Sparkle background (JS will generate sparkles) -->
    <div id="sparkle-bg" style="pointer-events:none;z-index:0;position:fixed;top:0;left:0;width:100vw;height:100vh;"></div>

    <!-- Message Box Overlay -->
    <div id="messageBoxOverlay" class="message-box-overlay">
        <div class="message-box-content">
            <p id="messageBoxText" class="text-lg font-medium"></p>
            <button id="messageBoxCloseButton">OK</button>
        </div>
    </div>

   <div class="flex flex-col items-center justify-center min-h-screen p-4 md:p-8 gap-12 main-content-entrance">
        <!-- Welcome Header -->
        <div class="absolute top-8 md:top-12 w-11/12 max-w-2xl bg-opacity-80 text-white text-center py-3 px-6 rounded-full shadow-lg 
        text-lg md:text-xl font-semibold tracking-wide" 
        style="background:linear-gradient(90deg,#a78e81e0 60%, #e3dcd3e8 100%);box-shadow:0 4px 18px #a78e8133;">
            Welcome To RoomieHaus Budget Tracker....
        </div>

        <!-- Main Content Area -->
        <div class="flex flex-col md:flex-row items-center justify-center w-full max-w-6xl mt-24 md:mt-0">
            <!-- Left Section: House and Characters -->
            <div class="relative flex-shrink-0 w-full md:w-1/2 flex justify-center items-center mb-8 md:mb-0">
                <!-- 3D Model Viewer with floating and glow -->
                <div class="glow-border float" style="width:100%;max-width:500px;height:400px;display:flex;align-items:center;justify-content:center;">
                  <model-viewer 
                    src="{{ url_for('static', filename='model/marriedroom.glb') }}" 
                    alt="3D Married Room"
                    auto-rotate
                    camera-controls
                    ar
                    ar-modes="webxr scene-viewer quick-look"
                    shadow-intensity="1"
                    exposure="0.75"
                    style="width: 100%; height: 400px; border-radius: 0.75rem; background:transparent;">
                  </model-viewer>
                </div>
                <!-- Aura's Name -->
                <div id="auraName" class="speech-bubble absolute text-gray-800 font-semibold text-sm md:text-base shadow-lg" 
                    style="top: 25%; left: 25%; transform: translate(-50%, -100%);">
                    {{partner1}}
                </div>
                <!-- Khansa's Name -->
                <div id="khansaName" class="speech-bubble absolute text-gray-800 font-semibold text-sm md:text-base shadow-lg"
                    style="top: 25%; right: 25%; transform: translate(50%, -100%);">
                    {{partner2}}
                </div>
            </div>
            <!-- Right Section: Report Prompt with modern prompt-box class -->
            <div class="flex flex-col items-center md:items-start text-center md:text-left w-full md:w-1/2 p-4 md:p-8">
                <div class="prompt-box max-w-md md:max-w-none">
                    <p class="text-xl md:text-2xl font-semibold mb-2">Wanna Check About Who's Report Today?</p>
                    <p class="text-base md:text-lg">Touch one of the name to find out the report!</p>
                </div>
            </div>
        </div>
    </div>
    <!-- Back Arrow Button -->
    <div class="absolute bottom-8 left-8 z-20">
        <button id="backButton" class="back-button" aria-label="Go Back">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
            </svg>
        </button>
    </div>
    <audio id="bubbleSound" src="https://cdn.pixabay.com/audio/2022/07/26/audio_124bfae8e8.mp3"></audio>
    <script>
        // Sparkle background generator
        function randomBetween(min, max) { return Math.random() * (max - min) + min; }
        function createSparkle() {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            const size = randomBetween(8, 22);
            sparkle.style.width = `${size}px`;
            sparkle.style.height = `${size}px`;
            sparkle.style.left = `${randomBetween(0, 100)}vw`;
            sparkle.style.top = '110vh';
            sparkle.style.opacity = randomBetween(0.19, 0.75);
            sparkle.style.filter = `blur(${randomBetween(0,2)}px)`;
            sparkle.style.animationDuration = `${randomBetween(7, 13)}s`;
            document.getElementById('sparkle-bg').appendChild(sparkle);
            setTimeout(() => {
                sparkle.remove();
            }, 13000);
        }
        setInterval(() => {
            if (document.hidden) return;
            for (let i=0; i<2; ++i) createSparkle();
        }, 700);

        // Micro-interactions & logic
        function showMessageBox(message) {
            const messageBoxOverlay = document.getElementById('messageBoxOverlay');
            const messageBoxText = document.getElementById('messageBoxText');
            messageBoxText.textContent = message;
            messageBoxOverlay.classList.add('active');
        }
        function hideMessageBox() {
            document.getElementById('messageBoxOverlay').classList.remove('active');
        }
        document.addEventListener('DOMContentLoaded', () => {
            const auraName = document.getElementById('auraName');
            const khansaName = document.getElementById('khansaName');
            const backButton = document.getElementById('backButton');
            const messageBoxCloseButton = document.getElementById('messageBoxCloseButton');
            const bubbleSound = document.getElementById('bubbleSound');
            function playBubbleSound() {
                if (bubbleSound) {
                    bubbleSound.currentTime = 0;
                    bubbleSound.play().catch(() => {});
                }
            }
            function bounce(el) {
                el.style.animation = 'bubbleBounce 0.32s';
                setTimeout(() => { el.style.animation = ''; }, 370);
            }
            auraName.addEventListener('click', () => {
                playBubbleSound();
                bounce(auraName);
                const name = auraName.innerText;
                showMessageBox(`Checking ${name}'s report...`);
            });
            khansaName.addEventListener('click', () => {
                playBubbleSound();
                bounce(khansaName);
                const name = khansaName.innerText;
                showMessageBox(`Checking ${name}'s report...`);
            });
            backButton.addEventListener('click', () => {
                window.history.back();
            });
            messageBoxCloseButton.addEventListener('click', () => {
                window.location.href = '/budget-page';
            });
            document.getElementById('messageBoxOverlay').addEventListener('click', (event) => {
                if (event.target.id === 'messageBoxOverlay') {
                    hideMessageBox();
                }
            });
            // Main entrance animation delay for extra "wow"
            setTimeout(() => {
                document.querySelector('.main-content-entrance').style.animationDelay = '0.25s';
            }, 30);
        });
    </script>
</body>
</html>